{
  "swagger": "2.0",
  "info": {
    "title": "CNAB",
    "description": "The Microsoft.CNAB Rest API spec.",
    "version": "2021-02-12-preview",
    "x-ms-code-generation-settings": {
      "name": "CNABClient"
    }
  },
  "host": "management.azure.com",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.CNAB/installations/{installationsName}": {
      "get": {
        "operationId": "installations_Retrieve",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ResourceGroupNameParameter"
          },
          {
            "$ref": "#/parameters/installationsNameParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Retrieves the installations resource.",
            "schema": {
              "$ref": "#/definitions/installations"
            }
          }
        }
      },
      "put": {
        "operationId": "installations_CreateOrUpdate",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ResourceGroupNameParameter"
          },
          {
            "$ref": "#/parameters/installationsNameParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          },
          {
            "name": "installations",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/installations"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Updates the installations resource.",
            "schema": {
              "$ref": "#/definitions/installations"
            }
          },
          "201": {
            "description": "Creates the installations resource.",
            "schema": {
              "$ref": "#/definitions/installations"
            }
          }
        }
      },
      "delete": {
        "operationId": "installations_Delete",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ResourceGroupNameParameter"
          },
          {
            "$ref": "#/parameters/installationsNameParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Deletes the installations resource."
          }
        }
      },
      "patch": {
        "operationId": "installations_Update",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ResourceGroupNameParameter"
          },
          {
            "$ref": "#/parameters/installationsNameParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          },
          {
            "name": "installations",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/installationsPatch"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Updates the installations resource.",
            "schema": {
              "$ref": "#/definitions/installations"
            }
          },
          "201": {
            "description": "Updates the installations resource.",
            "schema": {
              "$ref": "#/definitions/installations"
            }
          }
        }
      }
    },
    "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.CNAB/installations": {
      "get": {
        "operationId": "installations_ListByResourceGroup",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ResourceGroupNameParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Lists all installations under the resouce group.",
            "schema": {
              "$ref": "#/definitions/installationsListResult"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        }
      }
    },
    "/subscriptions/{subscriptionId}/providers/Microsoft.CNAB/installations": {
      "get": {
        "operationId": "installations_ListBySubscription",
        "parameters": [
          {
            "$ref": "#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Lists all installations under the subscription.",
            "schema": {
              "$ref": "#/definitions/installationsListResult"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        }
      }
    },
    "/providers/Microsoft.CNAB/operations": {
      "get": {
        "operationId": "Operations_List",
        "parameters": [
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Describe the result of a successful operation.",
            "schema": {
              "$ref": "#/definitions/ResourceProviderOperationList"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        }
      }
    }
  },
  "definitions": {
    "installationsProperties": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "description": "Action defined in the bundle to execute. If unspecified, Porter will run an install if the installation does not exist, or an upgrade otherwise."
        },
        "agentConfig": {
          "type": "object",
          "properties": {
            "porterRepository": {
              "type": "string",
              "description": "PorterRepository is the repository for the Porter Agent image. Defaults to ghcr.io/getporter/porter"
            },
            "porterVersion": {
              "type": "string",
              "description": "PorterVersion is the tag for the Porter Agent image. Defaults to latest."
            },
            "pullPolicy": {
              "type": "string",
              "description": "PullPolicy specifies when to pull the Porter Agent image. The default is to use PullAlways when the tag is canary or latest, and PullIfNotPresent otherwise."
            },
            "serviceAccount": {
              "type": "string",
              "description": "ServiceAccount is the service account to run the Porter Agent under."
            },
            "volumeSize": {
              "description": "VolumeSize is the size of the persistent volume that Porter will request when running the Porter Agent. It is used to share data between the Porter Agent and the bundle invocation image. It must be large enough to store any files used by the bundle including credentials, parameters and outputs.",
              "pattern": "^(\\+|-)?(([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\\+|-)?(([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))))?$",
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "string"
                }
              ],
              "x-kubernetes-int-or-string": "true"
            }
          },
          "description": "AgentConfig overrides the Porter Agent configuration defined at the namespace or system level."
        },
        "credentialSets": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "CredentialSets is a list of credential set names."
        },
        "parameterSets": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "ParameterSets is a list of parameter set names."
        },
        "parameters": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Parameters is a list of parameter set names."
        },
        "reference": {
          "type": "string",
          "description": "Reference to the bundle in an OCI Registry, e.g. getporter/porter-hello:v0.1.1."
        },
        "provisioningState": {
          "type": "string"
        },
        "status": {
          "type": "object",
          "properties": {
            "activeJob": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?"
                }
              },
              "description": "INSERT ADDITIONAL STATUS FIELD - define observed state of cluster Important: Run \"make\" to regenerate code after modifying this file"
            },
            "lastJob": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?"
                }
              },
              "description": "LocalObjectReference contains enough information to let you locate the referenced object inside the same namespace."
            }
          },
          "description": "InstallationStatus defines the observed state of Installation"
        }
      },
      "required": [
        "action",
        "reference"
      ],
      "description": "InstallationSpec defines the desired state of Installation"
    },
    "installations": {
      "type": "object",
      "properties": {
        "properties": {
          "$ref": "#/definitions/installationsProperties"
        },
        "id": {
          "type": "string",
          "readOnly": true,
          "description": "Resource Id"
        },
        "name": {
          "type": "string",
          "readOnly": true,
          "description": "Resource Name"
        },
        "type": {
          "type": "string",
          "readOnly": true,
          "description": "Resource Type"
        },
        "location": {
          "type": "string",
          "description": "The resource location"
        },
        "tags": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Resource tags"
        },
        "extendedLocation": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "description": "The extended location type."
            },
            "name": {
              "type": "string",
              "description": "The extended location name."
            }
          }
        }
      },
      "required": [
        "location"
      ],
      "description": "The installations resource definition."
    },
    "installationsPatch": {
      "type": "object",
      "properties": {
        "tags": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Resource tags"
        }
      },
      "description": "The installations resource patch definition."
    },
    "installationsListResult": {
      "type": "object",
      "properties": {
        "value": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/installations"
          }
        },
        "nextLink": {
          "type": "string"
        }
      }
    },
    "ResourceProviderOperationList": {
      "type": "object",
      "properties": {
        "value": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ResourceProviderOperation"
          }
        },
        "nextLink": {
          "type": "string"
        }
      },
      "description": "Results of the request to list operations."
    },
    "ResourceProviderOperation": {
      "type": "object",
      "properties": {
        "isDataAction": {
          "type": "string",
          "description": "Indicates whether the operation applies to data-plane."
        },
        "name": {
          "type": "string",
          "description": "Operation name, in format of {provider}/{resource}/{operation}"
        },
        "display": {
          "type": "object",
          "properties": {
            "provider": {
              "type": "string",
              "description": "The resource provider."
            },
            "resource": {
              "type": "string",
              "description": "Resource on which the operation is performed."
            },
            "operation": {
              "type": "string",
              "description": "Type of operation: get, read, delete, etc."
            },
            "description": {
              "type": "string",
              "description": "Description of this operation."
            }
          },
          "description": "Display metadata associated with the operation."
        }
      },
      "description": "Results of the request to list operations."
    }
  },
  "parameters": {
    "installationsNameParameter": {
      "name": "installationsName",
      "in": "path",
      "required": true,
      "type": "string",
      "maxLength": 64,
      "minLength": 3
    },
    "SubscriptionIdParameter": {
      "name": "subscriptionId",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000)"
    },
    "ResourceGroupNameParameter": {
      "name": "resourceGroupName",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The name of the resource group."
    },
    "ApiVersionParameter": {
      "name": "api-version",
      "in": "query",
      "required": true,
      "type": "string",
      "description": "The API version to be used with the HTTP request (e.g. YYYY-MM-DD)."
    }
  }
}